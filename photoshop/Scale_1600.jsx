// enable double clicking from the // Macintosh Finder or the Windows Explorer#target photoshop// Make Photoshop the frontmost applicationapp.bringToFront();/////////////////////////// SETUP/////////////////////////var maxSide = 1600;var jpg_quality = 10; //0-12   var jpgSaveOptions = new JPEGSaveOptions();  jpgSaveOptions.embedColorProfile = true;  jpgSaveOptions.formatOptions = FormatOptions.STANDARDBASELINE;  jpgSaveOptions.matte = MatteType.NONE;  jpgSaveOptions.quality = jpg_quality ;  var web_quality = 90; //0-100   var sfwOptions = new ExportOptionsSaveForWeb();   sfwOptions.format = SaveDocumentType.JPEG;   sfwOptions.includeProfile = false;   sfwOptions.interlaced = 0;   sfwOptions.optimized = true;   sfwOptions.quality = web_quality;/////////////////////////// MAIN/////////////////////////var i = 0while (app.documents.length > 0) {	app.activeDocument = app.documents[app.documents.length-1];	var doc = app.activeDocument; 	doc.changeMode(ChangeMode.RGB);  	if (doc.height > maxSide || doc.width > maxSide) {		if (doc.height > doc.width) {			//alert( doc.height + "!")			doc.resizeImage(null,UnitValue(maxSide,"px"),null,ResampleMethod.BICUBICSHARPER);		}		else {			//alert( doc.width + "!" )			doc.resizeImage(UnitValue(maxSide,"px"),null,null,ResampleMethod.BICUBICSHARPER);		}	}	else {		alert( doc.width + " x " + doc.height + " is OK")	}		// var doc_name = doc.name.replace(".jpg", "")	// var doc_name = doc.name.replace(".JPG", "")		// var target_path = doc.path + "/../small/"  + doc.name;	var target_path = doc.path + "/small/" + doc.name;		// alert( target_path )		var save_file = new File(target_path);	doc.saveAs(save_file, jpgSaveOptions, true, Extension.LOWERCASE);		//// doc.exportDocument(save_file, ExportType.SAVEFORWEB, sfwOptions);		doc.close(SaveOptions.DONOTSAVECHANGES); }// alert("done")