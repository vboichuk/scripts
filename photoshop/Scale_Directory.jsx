// enable double clicking from the // Macintosh Finder or the Windows Explorer#target photoshop// Make Photoshop the frontmost applicationapp.bringToFront();/////////////////////////// SETUP/////////////////////////var maxSide = 1600;var jpg_quality = 10; //0-12   var jpgSaveOptions = new JPEGSaveOptions();  jpgSaveOptions.embedColorProfile = true;  jpgSaveOptions.formatOptions = FormatOptions.STANDARDBASELINE;  jpgSaveOptions.matte = MatteType.NONE;  jpgSaveOptions.quality = jpg_quality ;  var web_quality = 90; //0-100   var sfwOptions = new ExportOptionsSaveForWeb();   sfwOptions.format = SaveDocumentType.JPEG;   sfwOptions.includeProfile = false;   sfwOptions.interlaced = 0;   sfwOptions.optimized = true;   sfwOptions.quality = web_quality;/////////////////////////function scaleIfNeeded(file) {		// alert(file);		var doc = open(file);	doc.changeMode(ChangeMode.RGB);		// alert("" + doc.height + "")		if (doc.height > maxSide || doc.width > maxSide) {		if (doc.height > doc.width)			doc.resizeImage(null,UnitValue(maxSide,"px"),null,ResampleMethod.BICUBICSHARPER);		else 			doc.resizeImage(UnitValue(maxSide,"px"),null,null,ResampleMethod.BICUBICSHARPER);		doc.saveAs(file, jpgSaveOptions, true, Extension.LOWERCASE);	}	doc.close(SaveOptions.DONOTSAVECHANGES);}/////////////////////////// MAIN/////////////////////////// var inputFolder = new Folder('E:/HomePhoto/Бердянск_2010 - Copy');var inputFolder = Folder.selectDialog("Select a folder to process");		 var mask = /.(jpg|jpeg|JPG|JPEG|png)$/var files = inputFolder.getFiles();   var win = new Window("palette", "Production");win.size = [250,50];win.alignChildren = "center";win.progressbar = win.add("progressbar",[0,0,200,12]);win.progressbar.minvalue=0;win.progressbar.value = 0;win.progressbar.maxvalue = files.length;win.show();for (var i = 0; i < files.length; i++){	if (files[i] instanceof File )	{  		// if (mask == undefined) || files[i].fullName.search(mask) != -1) 		 // Convert the file object to a string for matching purposes (match only works on String objects)  		   var fileString = String(files[i]);  		   // Check if the file contains the right extension  		   if (fileString.match(/.(jpg|jpeg|JPG|JPEG|png)$/))  		{			scaleIfNeeded(files[i]);		} 		else		{			alert(fileString + 'bad file');  
		}	}	win.progressbar.value ++; 	// win.layout.layout(true);	// win.update();}alert("Done!")